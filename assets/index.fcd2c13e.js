import{c as I,d as P,Z as D,u as R,a as c,q as G,t as A,G as O,f as W,w as N,H as j,F as z,D as H,o as V,g as T,_ as w,$ as K,a0 as L,h as B,S as X,l as Y,r as J,a1 as C,a2 as k,W as x,a3 as Q,V as ee,a4 as te,X as ne,a5 as ae,a6 as re,a7 as oe}from"./index.cb71e29c.js";import{N as le}from"./index.89d9f226.js";import{r as se,l as ie}from"./user.54dcb223.js";import{B as ue}from"./index.09e405b4.js";import{C as ce}from"./index.cdff57ac.js";import"./index.ab7f0976.js";import{F as de}from"./index.ff20f038.js";import{_ as Z}from"./_plugin-vue_export-helper.cdc0426e.js";import"./use-placeholder.635160f2.js";import"./use-route.eedd3dde.js";import"./use-id.56b9d669.js";const[me,fe]=I("form"),ge={colon:Boolean,disabled:Boolean,readonly:Boolean,showError:Boolean,labelWidth:G,labelAlign:String,inputAlign:String,scrollToError:Boolean,validateFirst:Boolean,submitOnEnter:A,showErrorMessage:A,errorMessageAlign:String,validateTrigger:{type:[String,Array],default:"onBlur"}};var pe=P({name:me,props:ge,emits:["submit","failed"],setup(t,{emit:o,slots:a}){const{children:r,linkChildren:i}=D(O),n=e=>e?r.filter(l=>e.includes(l.name)):r,u=e=>new Promise((l,m)=>{const p=[];n(e).reduce((M,U)=>M.then(()=>{if(!p.length)return U.validate().then($=>{$&&p.push($)})}),Promise.resolve()).then(()=>{p.length?m(p):l()})}),g=e=>new Promise((l,m)=>{const p=n(e);Promise.all(p.map(f=>f.validate())).then(f=>{f=f.filter(Boolean),f.length?m(f):l()})}),s=e=>{const l=r.find(m=>m.name===e);return l?new Promise((m,p)=>{l.validate().then(f=>{f?p(f):m()})}):Promise.reject()},d=e=>typeof e=="string"?s(e):t.validateFirst?u(e):g(e),v=e=>{typeof e=="string"&&(e=[e]),n(e).forEach(m=>{m.resetValidation()})},S=()=>r.reduce((e,l)=>(e[l.name]=l.getValidationStatus(),e),{}),y=(e,l)=>{r.some(m=>m.name===e?(m.$el.scrollIntoView(l),!0):!1)},h=()=>r.reduce((e,l)=>(e[l.name]=l.formValue.value,e),{}),b=()=>{const e=h();d().then(()=>o("submit",e)).catch(l=>{o("failed",{values:e,errors:l}),t.scrollToError&&l[0].name&&y(l[0].name)})},_=e=>{W(e),b()};return i({props:t}),R({submit:b,validate:d,getValues:h,scrollToField:y,resetValidation:v,getValidationStatus:S}),()=>{var e;return c("form",{class:fe(),onSubmit:_},[(e=a.default)==null?void 0:e.call(a)])}}});const _e=N(pe),[E,ve]=I("space"),ye={align:String,direction:{type:String,default:"horizontal"},size:{type:[Number,String,Array],default:8},wrap:Boolean,fill:Boolean};function q(t=[]){const o=[];return t.forEach(a=>{Array.isArray(a)?o.push(...a):a.type===z?o.push(...q(a.children)):o.push(a)}),o.filter(a=>{var r;return!(a&&(typeof Comment<"u"&&a.type===Comment||a.type===z&&((r=a.children)==null?void 0:r.length)===0||a.type===Text&&a.children.trim()===""))})}var he=P({name:E,props:ye,setup(t,{slots:o}){const a=j(()=>{var n;return(n=t.align)!=null?n:t.direction==="horizontal"?"center":""}),r=n=>typeof n=="number"?n+"px":n,i=n=>{const u={},g=`${r(Array.isArray(t.size)?t.size[0]:t.size)}`,s=`${r(Array.isArray(t.size)?t.size[1]:t.size)}`;return n?t.wrap?{marginBottom:s}:{}:(t.direction==="horizontal"&&(u.marginRight=g),(t.direction==="vertical"||t.wrap)&&(u.marginBottom=s),u)};return()=>{var n;const u=q((n=o.default)==null?void 0:n.call(o));return c("div",{class:[ve({[t.direction]:t.direction,[`align-${a.value}`]:a.value,wrap:t.wrap,fill:t.fill})]},[u.map((g,s)=>c("div",{key:`item-${s}`,class:`${E}-item`,style:i(s===u.length-1)},[g]))])}}});const be=N(he);const we={class:"login"},Se={style:{margin:"16px"}},xe={__name:"login_form",props:{type:{type:String,default:"login"}},emits:["submit"],setup(t,{emit:o}){const a=t,r=H({email:"",username:"",password:""});function i(s){o("submit",{type:a.type,...r})}function n(s){return/^[a-zA-Z0-9_-]{6,16}$/.test(s)}function u(s){return console.log(s),/^[A-Za-z\d]+([-_.][A-Za-z\d]+)*@([A-Za-z\d]+[-.])+[A-Za-z\d]{2,5}$/.test(s)}function g(s){return/^[\@A-Za-z0-9\!\#\$\%\^\&\*\.\-\_\~\(\)]{6,20}$/.test(s)}return(s,d)=>{const v=de,S=ce,y=ue,h=_e,b=be;return V(),T("div",we,[c(b,{size:16,direction:"vertical",fill:""},{default:w(()=>[c(h,{onSubmit:i},{default:w(()=>[c(S,{inset:""},{default:w(()=>[t.type==="register"?(V(),K(v,{key:0,style:{"font-size":"16px"},type:"email",size:"large",modelValue:r.email,"onUpdate:modelValue":d[0]||(d[0]=_=>r.email=_),name:"",label:"",placeholder:"\u90AE\u7BB1",center:"",rules:[{validator:u,required:!0,message:"\u8BF7\u586B\u5199\u7684\u90AE\u7BB1"}]},null,8,["modelValue","rules"])):L("",!0),c(v,{style:{"font-size":"16px"},size:"large",modelValue:r.username,"onUpdate:modelValue":d[1]||(d[1]=_=>r.username=_),name:"",label:"",placeholder:"\u7528\u6237\u540D",center:"",rules:[{validator:n,required:!0,message:"\u8BF7\u586B\u5199\u7528\u6237\u540D,\u4E0D\u80FD\u5C11\u4E8E6\u4F4D\u6570"}]},null,8,["modelValue","rules"]),c(v,{style:{"font-size":"16px"},size:"large",modelValue:r.password,"onUpdate:modelValue":d[2]||(d[2]=_=>r.password=_),type:"password",name:"",label:"",placeholder:"\u5BC6\u7801",center:"",clearable:"",rules:[{validator:g,required:!0,message:"\u8BF7\u586B\u5199\u5BC6\u7801,\u4E0D\u80FD\u5C11\u4E8E6\u4F4D\u6570"}]},null,8,["modelValue","rules"])]),_:1}),B("div",Se,[c(y,{class:"login_button","native-type":"submit",type:"primary",round:"",block:""},{default:w(()=>[X(Y(t.type==="login"?"\u767B\u5F55":"\u6CE8\u518C"),1)]),_:1})])]),_:1})]),_:1})])}}},F=Z(xe,[["__scopeId","data-v-4a0ba368"]]);const ze=t=>(re("data-v-f3c502f7"),t=t(),oe(),t),Ve={class:"login_logo"},Be=ze(()=>B("div",null,"iChat \u4E00\u6B3E\u804A\u5929\u5E94\u7528",-1)),$e={__name:"index",setup(t){const o=J("login"),a=i=>{o.value=i},r=async i=>{if(!i.username||!i.password){await x("\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u7528\u6237\u6216\u5BC6\u7801");return}x.loading({message:"",forbidClick:!0});try{let n=null;i.type==="register"?n=await se(i):n=await ie(i),Q().setUserInfo(n.data),ee.setItem("userInfo",n.data),te.emit("login"),ne.push("/"),x.clear()}catch{}};return(i,n)=>{const u=le,g=ae;return V(),T(z,null,[c(u,{"left-arrow":o.value!=="login",title:o.value==="login"?"":"\u6CE8\u518C","right-text":o.value==="login"?"\u6CE8\u518C":"",onClickLeft:n[0]||(n[0]=s=>a("login")),onClickRight:n[1]||(n[1]=s=>a("register")),border:!1},null,8,["left-arrow","title","right-text"]),B("div",Ve,[c(g,{class:"logo",width:"58",height:"58",src:"icon.svg"}),Be]),C(c(F,{onSubmit:r,key:"login",type:o.value},null,8,["type"]),[[k,o.value==="login"]]),C(c(F,{onSubmit:r,key:"register",type:o.value},null,8,["type"]),[[k,o.value==="register"]])],64)}}},Me=Z($e,[["__scopeId","data-v-f3c502f7"]]);export{Me as default};
