import{c as I,d as P,Z as R,u as U,a as c,q as G,t as z,G as O,f as W,w as N,H as j,F as B,_ as T,D as H,o as $,g as Z,$ as w,a0 as K,a1 as L,h as A,S as X,l as Y,r as J,a2 as C,a3 as k,W as V,a4 as Q,V as ee,X as te,a5 as ae,a6 as ne,a7 as re}from"./index.cbf740b8.js";import{N as oe}from"./index.7ee81d01.js";import{r as le,l as se}from"./user.38720db7.js";import{B as ie}from"./index.9ce463fe.js";import{C as ue}from"./index.7b7267f9.js";import"./index.adf01fa5.js";import{F as ce}from"./index.9319eb70.js";import"./use-placeholder.1543164c.js";import"./use-route.7f7622c4.js";import"./use-id.60b42970.js";const[de,me]=I("form"),ge={colon:Boolean,disabled:Boolean,readonly:Boolean,showError:Boolean,labelWidth:G,labelAlign:String,inputAlign:String,scrollToError:Boolean,validateFirst:Boolean,submitOnEnter:z,showErrorMessage:z,errorMessageAlign:String,validateTrigger:{type:[String,Array],default:"onBlur"}};var fe=P({name:de,props:ge,emits:["submit","failed"],setup(t,{emit:o,slots:n}){const{children:r,linkChildren:i}=R(O),a=e=>e?r.filter(l=>e.includes(l.name)):r,u=e=>new Promise((l,m)=>{const p=[];a(e).reduce((q,D)=>q.then(()=>{if(!p.length)return D.validate().then(x=>{x&&p.push(x)})}),Promise.resolve()).then(()=>{p.length?m(p):l()})}),f=e=>new Promise((l,m)=>{const p=a(e);Promise.all(p.map(g=>g.validate())).then(g=>{g=g.filter(Boolean),g.length?m(g):l()})}),s=e=>{const l=r.find(m=>m.name===e);return l?new Promise((m,p)=>{l.validate().then(g=>{g?p(g):m()})}):Promise.reject()},d=e=>typeof e=="string"?s(e):t.validateFirst?u(e):f(e),v=e=>{typeof e=="string"&&(e=[e]),a(e).forEach(m=>{m.resetValidation()})},S=()=>r.reduce((e,l)=>(e[l.name]=l.getValidationStatus(),e),{}),y=(e,l)=>{r.some(m=>m.name===e?(m.$el.scrollIntoView(l),!0):!1)},h=()=>r.reduce((e,l)=>(e[l.name]=l.formValue.value,e),{}),b=()=>{const e=h();d().then(()=>o("submit",e)).catch(l=>{o("failed",{values:e,errors:l}),t.scrollToError&&l[0].name&&y(l[0].name)})},_=e=>{W(e),b()};return i({props:t}),U({submit:b,validate:d,getValues:h,scrollToField:y,resetValidation:v,getValidationStatus:S}),()=>{var e;return c("form",{class:me(),onSubmit:_},[(e=n.default)==null?void 0:e.call(n)])}}});const pe=N(fe),[E,_e]=I("space"),ve={align:String,direction:{type:String,default:"horizontal"},size:{type:[Number,String,Array],default:8},wrap:Boolean,fill:Boolean};function M(t=[]){const o=[];return t.forEach(n=>{Array.isArray(n)?o.push(...n):n.type===B?o.push(...M(n.children)):o.push(n)}),o.filter(n=>{var r;return!(n&&(typeof Comment<"u"&&n.type===Comment||n.type===B&&((r=n.children)==null?void 0:r.length)===0||n.type===Text&&n.children.trim()===""))})}var ye=P({name:E,props:ve,setup(t,{slots:o}){const n=j(()=>{var a;return(a=t.align)!=null?a:t.direction==="horizontal"?"center":""}),r=a=>typeof a=="number"?a+"px":a,i=a=>{const u={},f=`${r(Array.isArray(t.size)?t.size[0]:t.size)}`,s=`${r(Array.isArray(t.size)?t.size[1]:t.size)}`;return a?t.wrap?{marginBottom:s}:{}:(t.direction==="horizontal"&&(u.marginRight=f),(t.direction==="vertical"||t.wrap)&&(u.marginBottom=s),u)};return()=>{var a;const u=M((a=o.default)==null?void 0:a.call(o));return c("div",{class:[_e({[t.direction]:t.direction,[`align-${n.value}`]:n.value,wrap:t.wrap,fill:t.fill})]},[u.map((f,s)=>c("div",{key:`item-${s}`,class:`${E}-item`,style:i(s===u.length-1)},[f]))])}}});const he=N(ye);const be={class:"login"},we={style:{margin:"16px"}},Se={__name:"login_form",props:{type:{type:String,default:"login"}},emits:["submit"],setup(t,{emit:o}){const n=t,r=H({email:"",username:"",password:""});function i(s){o("submit",{type:n.type,...r})}function a(s){return/^[a-zA-Z0-9_-]{6,16}$/.test(s)}function u(s){return console.log(s),/^[A-Za-z\d]+([-_.][A-Za-z\d]+)*@([A-Za-z\d]+[-.])+[A-Za-z\d]{2,5}$/.test(s)}function f(s){return/^[\@A-Za-z0-9\!\#\$\%\^\&\*\.\-\_\~\(\)]{6,20}$/.test(s)}return(s,d)=>{const v=ce,S=ue,y=ie,h=pe,b=he;return $(),Z("div",be,[c(b,{size:16,direction:"vertical",fill:""},{default:w(()=>[c(h,{onSubmit:i},{default:w(()=>[c(S,{inset:""},{default:w(()=>[t.type==="register"?($(),K(v,{key:0,class:"field",type:"email",size:"large",modelValue:r.email,"onUpdate:modelValue":d[0]||(d[0]=_=>r.email=_),name:"",label:"",placeholder:"\u90AE\u7BB1",center:"",rules:[{validator:u,required:!0,message:"\u8BF7\u586B\u5199\u7684\u90AE\u7BB1"}]},null,8,["modelValue","rules"])):L("",!0),c(v,{class:"field",size:"large",modelValue:r.username,"onUpdate:modelValue":d[1]||(d[1]=_=>r.username=_),name:"",label:"",placeholder:"\u7528\u6237\u540D",center:"",rules:[{validator:a,required:!0,message:"\u8BF7\u586B\u5199\u7528\u6237\u540D,\u4E0D\u80FD\u5C11\u4E8E6\u4F4D\u6570"}]},null,8,["modelValue","rules"]),c(v,{class:"field",size:"large",modelValue:r.password,"onUpdate:modelValue":d[2]||(d[2]=_=>r.password=_),type:"password",name:"",label:"",placeholder:"\u5BC6\u7801",center:"",clearable:"",rules:[{validator:f,required:!0,message:"\u8BF7\u586B\u5199\u5BC6\u7801,\u4E0D\u80FD\u5C11\u4E8E6\u4F4D\u6570"}]},null,8,["modelValue","rules"])]),_:1}),A("div",we,[c(y,{class:"login_button","native-type":"submit",type:"primary",round:"",block:""},{default:w(()=>[X(Y(t.type==="login"?"\u767B\u5F55":"\u6CE8\u518C"),1)]),_:1})])]),_:1})]),_:1})])}}},F=T(Se,[["__scopeId","data-v-96e81181"]]);const Ve=t=>(ne("data-v-816ca45d"),t=t(),re(),t),Be={class:"login_logo"},$e=Ve(()=>A("div",null,"iChat \u4E00\u6B3E\u804A\u5929\u5E94\u7528",-1)),Ae={__name:"index",setup(t){const o=J("login"),n=i=>{o.value=i},r=async i=>{if(!i.username||!i.password){await V("\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u7528\u6237\u6216\u5BC6\u7801");return}V.loading({message:"",forbidClick:!0});try{let a=await(i.type==="register"?le(i):se(i));Q().setUserInfo(a.data),ee.setItem("userInfo",a.data),te.push("/message"),V.clear()}catch{}};return(i,a)=>{const u=oe,f=ae;return $(),Z(B,null,[c(u,{"left-arrow":o.value!=="login",title:o.value==="login"?"":"\u6CE8\u518C","right-text":o.value==="login"?"\u6CE8\u518C":"",onClickLeft:a[0]||(a[0]=s=>n("login")),onClickRight:a[1]||(a[1]=s=>n("register")),border:!1},null,8,["left-arrow","title","right-text"]),A("div",Be,[c(f,{class:"logo",src:"icon.svg"}),$e]),C(c(F,{onSubmit:r,key:"login",type:o.value},null,8,["type"]),[[k,o.value==="login"]]),C(c(F,{onSubmit:r,key:"register",type:o.value},null,8,["type"]),[[k,o.value==="register"]])],64)}}},Ze=T(Ae,[["__scopeId","data-v-816ca45d"]]);export{Ze as default};
